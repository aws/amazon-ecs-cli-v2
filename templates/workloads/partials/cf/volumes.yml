{{- if .Storage.Volumes}}
Volumes:
{{- if .Storage.ManagedVolumeInfo}}
  - Name: {{.Storage.ManagedVolumeInfo.Name}}
    EFSVolumeConfiguration:
      FilesystemId:
        Fn::ImportValue:
          !Sub '${AppName}-${EnvName}-FilesystemID'
      RootDirectory: "/"
      TransitEncryption: ENABLED
      AuthorizationConfig:
        AccessPointId: !Ref AccessPoint
        IAM: ENABLED
{{- end}}
{{- range $vol := .Storage.Volumes}}
  - Name: {{$vol.Name}}
    EFSVolumeConfiguration:
      FilesystemId: {{$vol.Filesystem}}
      RootDirectory: '{{$vol.RootDirectory}}'
      TransitEncryption: ENABLED
      {{- if or $vol.AccessPointID $vol.IAM}}
      AuthorizationConfig:
        {{- if $vol.AccessPointID}}
        AccessPointId: {{$vol.AccessPointID}}
        {{- end}}
        {{- if $vol.IAM}}
        IAM: {{$vol.IAM}}
        {{- end}}
      {{- end}}
{{- end -}}
{{- end -}}
